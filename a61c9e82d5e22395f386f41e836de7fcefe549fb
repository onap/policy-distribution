{
  "comments": [
    {
      "key": {
        "uuid": "9adffdf1_833309f5",
        "filename": "plugins/reception-plugins/src/main/java/org/onap/policy/distribution/reception/handling/file/FileSystemReceptionHandler.java",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 2787
      },
      "writtenOn": "2019-01-21T17:59:58Z",
      "side": 1,
      "message": "Could we call this method something else. Calling it \"main\" is very confusing. maybe startWatching, initWatching or some such name",
      "range": {
        "startLine": 91,
        "startChar": 16,
        "endLine": 91,
        "endChar": 20
      },
      "revId": "a61c9e82d5e22395f386f41e836de7fcefe549fb",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9adffdf1_d6946d8c",
        "filename": "plugins/reception-plugins/src/main/java/org/onap/policy/distribution/reception/handling/file/FileSystemReceptionHandler.java",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 3239
      },
      "writtenOn": "2019-01-22T11:59:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9adffdf1_833309f5",
      "range": {
        "startLine": 91,
        "startChar": 16,
        "endLine": 91,
        "endChar": 20
      },
      "revId": "a61c9e82d5e22395f386f41e836de7fcefe549fb",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9adffdf1_e338d5d4",
        "filename": "plugins/reception-plugins/src/main/java/org/onap/policy/distribution/reception/handling/file/FileSystemReceptionHandler.java",
        "patchSetId": 1
      },
      "lineNbr": 111,
      "author": {
        "id": 2787
      },
      "writtenOn": "2019-01-21T17:59:58Z",
      "side": 1,
      "message": "Likewise, may fileWatchLoop or some such name",
      "range": {
        "startLine": 111,
        "startChar": 19,
        "endLine": 111,
        "endChar": 32
      },
      "revId": "a61c9e82d5e22395f386f41e836de7fcefe549fb",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9adffdf1_768fc175",
        "filename": "plugins/reception-plugins/src/main/java/org/onap/policy/distribution/reception/handling/file/FileSystemReceptionHandler.java",
        "patchSetId": 1
      },
      "lineNbr": 111,
      "author": {
        "id": 3239
      },
      "writtenOn": "2019-01-22T11:59:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9adffdf1_e338d5d4",
      "range": {
        "startLine": 111,
        "startChar": 19,
        "endLine": 111,
        "endChar": 32
      },
      "revId": "a61c9e82d5e22395f386f41e836de7fcefe549fb",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9adffdf1_a343adad",
        "filename": "plugins/reception-plugins/src/main/java/org/onap/policy/distribution/reception/handling/file/FileSystemReceptionHandler.java",
        "patchSetId": 1
      },
      "lineNbr": 143,
      "author": {
        "id": 309
      },
      "writtenOn": "2019-01-22T00:50:58Z",
      "side": 1,
      "message": "what\u0027s main thread? Is this method createPolicyInputAndCallHandler always running in watcher thread?",
      "range": {
        "startLine": 143,
        "startChar": 53,
        "endLine": 143,
        "endChar": 54
      },
      "revId": "a61c9e82d5e22395f386f41e836de7fcefe549fb",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9adffdf1_631945d6",
        "filename": "plugins/reception-plugins/src/main/java/org/onap/policy/distribution/reception/handling/file/FileSystemReceptionHandler.java",
        "patchSetId": 1
      },
      "lineNbr": 143,
      "author": {
        "id": 309
      },
      "writtenOn": "2019-01-22T01:21:36Z",
      "side": 1,
      "message": "Sorry, let me rephrase my question. Do you know why here is a race condition between this watcher thread and main thread? From my understanding, the main thread just called initializeReception() to start the watcherThread and then it finishes. I\u0027m puzzled why IOException is raised here.\n \nMaybe we should resolve this issue by root causing the race condition here instead of just sleeping. Because this FileSystemReceptionHandler is used in S3P test, I don\u0027t think sleeping here is acceptable in performance test.",
      "parentUuid": "9adffdf1_a343adad",
      "range": {
        "startLine": 143,
        "startChar": 53,
        "endLine": 143,
        "endChar": 54
      },
      "revId": "a61c9e82d5e22395f386f41e836de7fcefe549fb",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9adffdf1_230fbd89",
        "filename": "plugins/reception-plugins/src/main/java/org/onap/policy/distribution/reception/handling/file/FileSystemReceptionHandler.java",
        "patchSetId": 1
      },
      "lineNbr": 143,
      "author": {
        "id": 2905
      },
      "writtenOn": "2019-01-22T01:33:10Z",
      "side": 1,
      "message": "agree.",
      "parentUuid": "9adffdf1_631945d6",
      "range": {
        "startLine": 143,
        "startChar": 53,
        "endLine": 143,
        "endChar": 54
      },
      "revId": "a61c9e82d5e22395f386f41e836de7fcefe549fb",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9adffdf1_1612f508",
        "filename": "plugins/reception-plugins/src/main/java/org/onap/policy/distribution/reception/handling/file/FileSystemReceptionHandler.java",
        "patchSetId": 1
      },
      "lineNbr": 143,
      "author": {
        "id": 3239
      },
      "writtenOn": "2019-01-22T11:59:16Z",
      "side": 1,
      "message": "Main thread refereed here is the thread that starts the whole distribution component starting from Main.java. This is the thread which reads the configuration json and creates all the handlers, decoders, forwarders \u0026 rest server and passes the configuration parameters to each one of them. The thread is active till the time distribution component is running.\n\nRegarding race condition, there seems to be race condition between the Watcher and the PolicyDecoder which tries to read the file and extract policies out of it.  The Watcher is too fast and triggers events immediately when the file is created in the folder. But operating system (in my case windows) is still in process of creating the file and it is not ready for reading.\nException trace:\njava.io.FileNotFoundException: C:\\onap\\service-Policyservice-csar.csar (The process cannot access the file because it is being used by another process)\n\nRegarding sleep, I agree that we might have better solutions of fixing it. I followed the approach for fixing it quickly. See this - https://stackoverflow.com/questions/15531144/java-7-watchservice-the-process-cannot-access-the-file-because-it-is-being-use\nMay be we can spend more time on this while doing the S3P tests in Dublin.\n@Pam - what do you say?\n\nHope I am able to answer you queries.",
      "parentUuid": "9adffdf1_230fbd89",
      "range": {
        "startLine": 143,
        "startChar": 53,
        "endLine": 143,
        "endChar": 54
      },
      "revId": "a61c9e82d5e22395f386f41e836de7fcefe549fb",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9adffdf1_76f10194",
        "filename": "plugins/reception-plugins/src/main/java/org/onap/policy/distribution/reception/handling/file/FileSystemReceptionHandler.java",
        "patchSetId": 1
      },
      "lineNbr": 143,
      "author": {
        "id": 3239
      },
      "writtenOn": "2019-01-22T12:16:32Z",
      "side": 1,
      "message": "Hold on I have got another quick solution for this. Will be submitting the patch soon.",
      "parentUuid": "9adffdf1_1612f508",
      "range": {
        "startLine": 143,
        "startChar": 53,
        "endLine": 143,
        "endChar": 54
      },
      "revId": "a61c9e82d5e22395f386f41e836de7fcefe549fb",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9adffdf1_c32911e7",
        "filename": "plugins/reception-plugins/src/main/java/org/onap/policy/distribution/reception/handling/file/FileSystemReceptionHandler.java",
        "patchSetId": 1
      },
      "lineNbr": 146,
      "author": {
        "id": 2905
      },
      "writtenOn": "2019-01-22T01:33:10Z",
      "side": 1,
      "message": "since the receptionHandlerParameters could receive more than one ReceptionHandler, once there are two handlers: SDC and FileSystem, how could this distributionStatistic reflect the status? do we need support more than one reception are used at the configuration file?",
      "revId": "a61c9e82d5e22395f386f41e836de7fcefe549fb",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9adffdf1_b6e0c929",
        "filename": "plugins/reception-plugins/src/main/java/org/onap/policy/distribution/reception/handling/file/FileSystemReceptionHandler.java",
        "patchSetId": 1
      },
      "lineNbr": 146,
      "author": {
        "id": 3239
      },
      "writtenOn": "2019-01-22T11:59:16Z",
      "side": 1,
      "message": "As per my understanding, Statistics endpoint must reflect the overall statistics of the distribution component. And not per reception handler based. So having more than one reception handler has no issues. They all must have implementation to update the overall stats.\nIf needed, we can extend the endpoint to additionally show statistics per reception handler.\n@Pam \u0026 Liam - Am I correct?",
      "parentUuid": "9adffdf1_c32911e7",
      "revId": "a61c9e82d5e22395f386f41e836de7fcefe549fb",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    }
  ]
}